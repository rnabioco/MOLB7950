---
title: "MOLB 7950: Informatics for Molecular Biology"
format:
  html:
    theme:
      light: [cosmo, style/quarto-main.scss]
      dark: [cosmo, style/dark.scss, style/quarto-main.scss]
    mainfont: "Atkinson Hyperlegible"
    code-copy: true
    code-overflow: wrap
    toc: true
---

```{r}
#| label: render_schedule_table
#| echo: false
#| message: false
#| warning: false
#| column: body
library(tidyverse)
library(glue)
library(gt)
library(emo)
library(here)

room <- 'AHSB 2201'
time <- '9:00-10:30am'

sched_tbl <- read_tsv(here('data/syllabus.tsv')) |>
  mutate(
    class      = row_number(),
    date       = ymd(date)
  ) |>
  arrange(date) |>
  mutate(
    class = str_pad(class, 2, 'left', '0'),
    week = isoweek(date),
    week = week - min(week) + 1,
    week = str_c('Week ', week),
    problem_set = as.character(problem_set)
  ) |>
  mutate(
    across(
      c(block, topic, instructor, title, problem_set),
      ~ replace_na(.x, '-')
    )
  ) |>
  mutate(
    # page links
    page_dir = str_c('content', block, glue('class-{class}.html'), sep = '/'),
    page_link   = glue('[{emo::ji("page")}]({page_dir})'), 
    page_link   = map(page_link, gt::md),
    # slides links
    slides_dir = str_c('content', block, glue('class-{class}.slides.html'), sep = '/'),
    slides_link   = glue('[{emo::ji("page")}]({slides_dir})'), 
    slides_link   = map(slides_link, gt::md),
  ) |>
  select(-ends_with('_dir'))

gt(
  sched_tbl,
  groupname_col = 'week',
  rowname_col = 'class'
  ) |>
  tab_header(
    title = md("**MOLB 7950 - Fall 2023 Schedule**"),
    subtitle = glue("Classes held in-person in {room}, {time}")
  ) |>
  fmt_date(
    columns = date,
    date_style = "wd_m_day_year"
  ) |>
  cols_align(
    align = 'center'
    ) |>
  cols_label(
    class = md("**Class**"),
    date = md("**Date**"),
    block = md("**Block**"),
    topic = md("**Topic**"),
    title = md("**Title**"),
    instructor = md("**Instructor**"),
    problem_set = md("**Problem Set**"),
    page_link = md("**Page**"),
    slides_link = md("**Slides**")
  ) |>
  tab_spanner(
    label = md("**Links**"),
    columns = ends_with('_link')
  ) |>
  opt_table_font(
    font = google_font('Atkinson Hyperlegible')
  ) |>
  tab_style(
    style = list(
      cell_text(align = "center")
    ),
    locations = cells_row_groups()
  ) |>
  tab_options(
    table.width = pct(100),
    quarto.use_bootstrap = TRUE
  ) |>
  tab_style(
    style = list(
      cell_fill("grey90")
      ),
    locations = cells_row_groups()
  ) |>
  opt_row_striping()
```
