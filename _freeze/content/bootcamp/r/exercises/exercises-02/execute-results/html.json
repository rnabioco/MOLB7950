{
  "hash": "1a3b8035749548bbe6bfd5571bfc156b",
  "result": {
    "markdown": "---\ntitle: \"Exercises-02\"\nauthor: \"Sujatha Jagannathan\"\ndate: \"8/25/2020\"\noutput: html_document\n---\n\n\n\n\n### Contact Info \nSuja Jagannathan [sujatha.jagannathan@cuanschutz.edu](mailto:sujatha.jagannathan@cuanschutz.edu)\n\n### Office Hours\nUse https://calendly.com/molb7950 to schedule a time with a TA.\n\n<br/>\n\n### Learning Objectives for the R Bootcamp\n\n* Follow best coding practices (*class 1*)\n* Know the fundamentals of R programming (*class 1*)\n* Become familiar with \"tidyverse\" suite of packages\n    * tidyr: \"Tidy\" a messy dataset (*class 2*)\n    * dplyr: Transform data to derive new information (*class 3*)\n    * ggplot2: Visualize and communicate results (*class 4*)\n* Practice reproducible analysis using Rmarkdown (Rigor & Reproducibility) (*classes 1-5*)\n\n### Today's class outline - *class 2*\n\n* Become familiar with \"tidyverse\" suite of packages\n* Introduce _readr_ (Exercise 1)\n* Introduce _tidyr_ (Exercise 2)\n* Tools for data exploration (Exercises 3-5)\n* Review basic functions of _tidyr_\n    * pivot_wider (Exercise 6)\n    * pivot_longer (Exercise 7)\n    * separate (Exercise 8 & 9)\n    * unite (Exercise 10)\n    * handling missing values\n* (if time permits) Regular expressions (regex)\n* Homework instructions\n\n------------------------------------------------------------------------------------------------------------\n\n### Tidyverse\n\n* Tidyverse is an opinionated collection of R packages designed for data science. \n* All packages share an underlying design philosophy, grammar, and data structures.\n* 25 packages, total (as of today) - we will focus mainly on tidyr, dplyr, and ggplot2\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](img/tidy1.png){width=60%}\n:::\n:::\n\n<br/>\nSource: R for Data Science by Hadley Wickham\n\n---\n\n### Data import - readr - Exercise 1\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](img/readr.png){width=70%}\n:::\n:::\n\n<br/>\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](img/readr-args.png){width=80%}\n:::\n:::\n\n<br/>\nSource: Rstudio cheatsheets\n\n- Let's try importing a small dataset - Exercise # 1\n\n::: {.cell}\n\n```{.r .cell-code}\ngetwd()  # good to know which folder you are on since the path to data file is relative - same as `pwd` in bash\nread_csv(file = \"exercises/data/mydata.csv\") # read in the file\nmydata.tbl # look at the contents of the data object\nd1 <- mydata.tbl # rename file\nd1 # look at contents of new object\nrm(mydata.tbl) # removing a dataset\n```\n:::\n\n\n__Note__: All of these functions can also be used in an interactive manner via `Environment` > `Import Dataset` > `From Text (readr)` \n\n---\n\n### What is tidy data?\n\n>   \"Tidy datasets are all alike but every messy dataset is messy in its own way.\"\n>   \n>   --- Hadley Wickham\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](img/tidydata.png){width=100%}\n:::\n:::\n\n<br/>\nSource: Rstudio cheatsheets\n\n---\n\n### Datasets for today's class - Exercise 2\n\n* In this class, we will use the datasets that come with the tidyr package to explore all the functions provided by tidyr. \n* Explore the contents of _tidyr_ package (Exercise #2)\n* `table1`, `table2`, `table3`, `table4a`, `table4b`, and `table5` all display the number of TB cases documented by the World Health Organization in Afghanistan, Brazil, and China between 1999 and 2000. \n\n\n### Getting familiar with the data - Exercise 3\n\nR provides many functions to examine features of a data object\n\n  - `View()` - To open the table up in an excel-like interface - not recommended for large tables\n  - `class()` - what kind of object is it (high-level)?\n  - `typeof()` - what is the object<e2><80><99>s data type (low-level)?\n  - `is_tibble()` - use is.? to confirm data type\n  - `str()` - what is the structure of the object?\n  - `attributes()` - does it have any metadata?\n  - `glimpse()` - another high level look at the data\n\n\n* Let's explore table1\n\n::: {.cell}\n\n```{.r .cell-code}\n  View(table1) # to look at the table in Viewer\n  table1 # to print the table to console\n  class(table1)\n  typeof(table1) \n  is_tibble(table1)\n  str(table1)\n  attributes(table1)\n  glimpse(table1)\n```\n:::\n\nNote: a `tibble` can be coerced into a data.frame using `as.data.frame(tbl)`\n\n\n### Getting familiar with the data - Exercise 4\n\nSome of the useful Data Frame Functions are as follows:  \n  - `head()` - shows first 6 rows  \n  - `tail()` - shows last 6 rows  \n  - `dim()` - returns the dimensions of data frame (i.e. number of rows and number of columns)  \n  - `nrow()` - number of rows  \n  - `ncol()` - number of columns  \n  - `names()` or `colnames()` - both show the names attribute for a data frame  \n  - `sapply(dataframe, class)` - shows the class of each column in the data frame*  \n\n*Iteration is not covered in this bootcamp. But there is a great primer on the package that does this, _purr_, on Rstudio Primers. https://rstudio.cloud/learn/primers/5\n\nMore functions to explore data - table2 this time. \n\n::: {.cell}\n\n```{.r .cell-code}\n  head(table2)\n  tail(table2)  \n  tail(table2, n = 8)  # specify number of lines to print\n  dim(table2) \n  nrow(table2)\n  ncol(table2)\n  names(table2)\n  sapply(table2, class)\n  class(table2) #observe the difference from the above command\n  glimpse(table2)\n```\n:::\n\n\n### Getting familiar with the data - _summary_, _hist_, & _table_ - Exercise 5\n\n_summary_: A generic function used to produce result summaries of the results of various model fitting functions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(table1) # summary of the whole table\nsummary(table1$cases) # summary of just one column of the table\n```\n:::\n\n\n_hist_: Takes in a vector of values and plots a histogram.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(table1$cases) # summary of just one column of the table\n```\n:::\n\n\n_table_: Uses the cross-classifying factors to build a contingency table of the counts at each combination of factor levels.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(table2$year) # tally of one column\ntable(table2$year, table2$year, table2$key) # two columns at a time\n```\n:::\n\n\n---\n\n<br/>\n### Questions? \n<br/>\n\n------------------------------------------------------------------------------------------------------------\n\n### Tidying data\n\nThe four verbs to keep in mind for reshaping data with `tidyr` are:  \n  - `pivot_wider`  \n  - `pivot_longer`  \n  - `separate`  \n  - `unite` \n\nThere are other verbs as well - as always, look at the `tidyr` cheatsheet!\n\n### pivot_wider - syntax\n\npivot_wider() \"widens\" data, increasing the number of columns and decreasing the number of rows. \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](img/pivot_wider.png){width=50%}\n:::\n:::\n\n\n```{show-code}\npivot_wider(\n  data,\n  names_from = name,\n  values_from = value,\n  ...\n)\n```\n\n\n### pivot_wider - Exercise 6\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyr)\ntable1 # this is a tidy dataset\ntable2 # this one is NOT tidy\n\npivot_wider(table2,\n            names_from = key,\n            values_from = value)\n\n# if you want to save the tidy table, you have to assign the output to a new object\ntable2_tidy <- pivot_wider(\n                      table2,\n                      names_from = key,\n                      values_from = value)\n\ntable2_tidy\n```\n:::\n\n\n### pivot_longer - Syntax\n\npivot_longer() \"lengthens\" data, increasing the number of rows and decreasing the number of columns. \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](img/pivot_longer.png){width=50%}\n:::\n:::\n\n\n```{show-code}\npivot_longer(\n  data,\n  cols,\n  names_to = \"name\",\n  values_to = \"value\",\n  ...\n)\n```\n\n### pivot_longer - Exercise 7\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable4\npivot_longer(table4, 2:3, names_to = \"year\", values_to = \"cases\")\npivot_longer(table4, `1999`:`2000`, \"year\", \"cases\")\ntable4_tidy <- pivot_longer(table4, 2:3, \"year\", \"cases\")\ntable4_tidy\n```\n:::\n\n\n### separate - Syntax\n\nGiven either a regular expression or a vector of character positions, separate() turns a single character column into multiple columns.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](img/separate.png){width=60%}\n:::\n:::\n\n\n```{show-code}\nseparate(\n  data,\n  col,\n  into,\n  sep = \"[^[:alnum:]]+\", #any sequence of non-alphanumeric values\n  remove = TRUE, # default is to remove the original column\n  convert = FALSE, # default is to not convert\n  extra = \"warn\",\n  fill = \"warn\",\n  ...\n)\n\n```\n\n### separate - Exercise 8\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable3\ntable3_tidy_1 <- separate(table3, \n                          rate, \n                          into = c(\"cases\", \"population\"), \n                          sep = \"/\")\ntable3_tidy_1\n```\n:::\n\n\n### separate_rows - Syntax\n\nGiven either a regular expression or a vector of character positions, separate() turns a single character column into multiple rows. \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](img/separate_rows.png){width=50%}\n:::\n:::\n\n\n```{show-code}\nseparate_rows(\n  data, \n  ..., \n  sep = \"[^[:alnum:].]+\", \n  convert = FALSE)\n```\n\n### separate_rows - Exercise 9\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable3\ntable3_tidy_2 <- separate_rows(table3, rate, sep = \"/\")\ntable3_tidy_2\n```\n:::\n\n\nThis is not a great example because in creating two rows, the case and population numbers are now mixed up and we have lost information. So always think about and be intentional to avoid information loss.  \n\n### unite - Syntax\n\nunite() combines multiple columns into a single column.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](img/unite.png){width=50%}\n:::\n:::\n\n\n```{show-code}\nunite(data, \n      col, \n      ..., #select columns to unite\n      sep = \"[^[:alnum:]]+\", #any sequence of non-alphanumeric values\n      remove = TRUE, #default is set to TRUE\n      na.rm = FALSE) #default is set to FALSE\n```\n\n### unite - Exercise 10\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable6 <- read_csv(file = \"exercises/data/table6.csv\")\ntable6_tidy <- unite(table6, \"new\", century, year, sep = \"\")\ntable6_tidy\n```\n:::\n\n\n------------------------------------------------------------------------------------------------------------\n\n### Handling missing values\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](img/missing-values.png){width=100%}\n:::\n:::\n\n<br/>\nSource: Rstudio cheatsheets\n\n---\n\n## Regular expressions\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](img/regex.png){width=80%}\n:::\n:::\n\n<br/>\nSource: Rstudio cheatsheets\n\nUseful website: [Regexr](https://regexr.com/)\n\nNote: _stringr_ is an entire package focused on working with character strings. I highly recommend checking it out! \n\n------------------------------------------------------------------------------------------------------------\n\n### Problem Set and Grading Rubric\n\n* Today's problem set assignment will allow you to practice the tidyr tools we learned in class today. \n* There is a total of 5 exercises, each with 4 points for a total of 20 points. \n* Link to [grading rubric](https://molb7950.netlify.app/policies/).\n\n### Acknowledgements\n\nThe material for this class was heavily borrowed from: \n* Data Science with R by Garrett Grolemund: https://garrettgman.github.io/tidying/\n* R for data science by Hadley Wickham: https://r4ds.had.co.nz/index.html\n\n### Further Reading & Resources \n\n* R for data science https://r4ds.had.co.nz/index.html\n* Advanced R by Hadley Wickam https://adv-r.hadley.nz/\n* Data Science with R by Garrett Grolemund https://garrettgman.github.io/tidying/\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}