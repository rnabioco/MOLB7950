{
  "hash": "4e472d1b9f7a55213133f5cd7ff3248b",
  "result": {
    "markdown": "---\ntitle: \"Exercises 8\"\nauthor: \"Jay Hesselberth\"\ndate: last-modified\nformat:\n  html:\n    toc: true\n    toc-depth: 2\n    code-fold: true\n---\n\n\n# Putting it all together\n\nFor the next two classes we'll combine everything we've learned to process and visualize data from some some biological experiments. These exercises will illustrate a complete analysis pipeline -- from data tidying to manipulation and visualization -- using tools from the tidyverse.\n\n![](../img/tidy-workflow.png)\n\n### Libraries\n\nLoad the libraries you need for analysis below.\n\n\n::: {.cell}\n\n:::\n\n\n# A quantitative PCR experiment\n\nHere is the experimental setup:\n\n-   Two cell lines (`wt` and `mut`) were treated with a drug that induces interferon expression\n\n-   After specific time points, cells were harvested and actin and interferon mRNA were analyzed by quantitative PCR (with 3 technical replicates), with a control containing no reverse transcriptase.\n\n### Load the data\n\nThese data are in two TSV files:\n\n-   `data/qpcr_names.tsv.gz`\n-   `data/qpcr_data.tsv.gz`\n\nLoad these data sets and inspect.\n\n\n::: {.cell}\n\n:::\n\n\nNote the shape of the data and the names of the rows and columns. Do they remind you of anything?\n\n![](../img/96-well-pcr-plate.png)\n\n### Tidy the data\n\nGiven the experimental setup and the shape of the tibbles, you should be able to answer: **Are these data tidy?**\n\n-   What are the variables in the data?\n-   Are the variables the column names?\n\n\n::: {.cell}\n\n:::\n\n\n### Merge the data\n\nNote the structure of the tidied data. What columns (variables) are shared by both tibbles?\n\nHow we can *join* the data from these two tibbles, linking the sample identifiers with their gene expression values?\n\n\n::: {.cell}\n\n:::\n\n\n### Summarize the data\n\nCalculate the mean and standard deviation across replicates.\n\nDo this two ways:\n\n1.  Calculate the statistics for each gene separately.\n\n2.  Calculate a ratio of interferon to actin levels for each sample *before* calculating the mean and standard deviation of the ratios.\n\n\n::: {.cell}\n\n:::\n\n\n### Plot the data\n\nNow we can plot the summary statistics. We'll use [`ggplot2::geom_pointrange()`](https://ggplot2.tidyverse.org/reference/geom_linerange.html) to represent the mean and standard deviation.\n\n\n::: {.cell}\n\n:::\n\n\n### Interpret the plot\n\n-   What can you say about the expression of ACTIN and IFN?\n\n-   What can you say about the mutant and wild-type cells?\n\n\n# A yeast gene expression experiment\n\nNext, we'll examine some gene expression data from the budding yeast *S. cerevisiae*. We'll roughly follow the analysis strategy taken by David Robinson in his blog [*Variance Explained*](http://varianceexplained.org/r/tidy-genomics-broom/).\n\nThe [data](http://growthrate.princeton.edu/transcriptome/download.shtml) come from:\n\n> Brauer MJ, Huttenhower C, Airoldi EM, Rosenstein R, Matese JC, Gresham D, Boer VM, Troyanskaya OG, Botstein D. **Coordination of growth rate, cell cycle, stress response, and metabolic activity in yeast.** *Mol Biol Cell.* 2008 [**\\[Link**\\]](https://pubmed.ncbi.nlm.nih.gov/17959824/)\n\nThey used [chemostats](https://dunham.gs.washington.edu/chemostatv2.htm) to control the growth rate of cells under different nutrient-limited conditions.\n\nIn this experiment, cells were grown in different media limited for (one of) glucose, uracil, leucine, sulfate, phosphate, or ammonia. Over a series of fixed, equilibrium growth rates (established by the dilution rate of fresh media), cells were harvested and gene expression was measured by genome-wide microarrays.\n\n### Load the data\n\nA raw version of the gene expression data are in:\n\n-   `data/brauer_gene_exp_wide.tsv.gz`\n\nIn addition, two tibbles contain related information:\n\n-   `data/yeast_go_terms.tsv.gz`\n-   `data/yeast_prot_prop.tsv.gz`\n\nLoad each of the above files and inspect.\n\n\n::: {.cell}\n\n:::\n\n\n### Tidy the data\n\n**Are these data tidy?**\n\n\n::: {.cell}\n\n:::\n\n\n### Heatmap of gene expression values\n\nHeatmaps are a useful approach to visualize thousands of data points, orgnaized by experimental variables to show patterns in the data.\n\nWe'll use the [ComplexHeatmap](https://jokergoo.github.io/ComplexHeatmap-reference/book/) package from Bioconductor, which provides a flexible framework for generating heatmaps.\n\n\n::: {.cell}\n\n:::\n\n\n### Expression of select genes associated with nutrient metabolism\n\nExamine genes (`common_name`) that start with LEU, URA, PHO, and SUL.\n\n\n::: {.cell}\n\n:::\n\n\n## Homework\n\nYour homework tonight is to review everything we did today. You won't have anything due tomorrow. There will be a more substantial problem set due on Friday at 5pm.\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}